(function(n){var t=3e5;String.prototype.padZero=function(n,t){for(var i=this,t=t||"0";i.length<n;)i=t+i;return i};n.newOrders=function(){n.ajax({method:"GET",url:"/Home/NewOrders",success:function(i){n("#newtotal").text(i.total);var r=n("#neworders").find("tbody");r.html("");i.orders.length>0?n.each(i.orders,function(n,t){r.append('<tr><td><a href="#" class="btn btn-link m-0 p-0" data-toggle="modal" data-target="#detailsModal" data-title="<i class=\'fa fa-list fa-fw\'><\/i> Detalles del pedido" data-url="/Order/DetailsOrder/'+t.orderId+'">'+t.orderId.toString().padZero(6,"0")+"<\/a><\/td><td>$"+t.orderTotal.toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")+"<\/td><td>"+t.customerName+"<\/td><\/tr>")}):r.append('<tr><td colspan="3"><span>No hay nuevos pedidos<\/span><\/td><\/tr>');setTimeout(n.newOrders,t)},error:function(t){t.status==401&&n("body").sessionTimeout("show")}})};n.processingOrders=function(){n.ajax({method:"GET",url:"/Home/ProcessingOrders",success:function(t){n("#processtotal").text(t.total);var i=n("#processorders").find("tbody");i.html("");t.orders.length>0?n.each(t.orders,function(n,t){i.append('<tr><td><a href="#" class="btn btn-link m-0 p-0" data-toggle="modal" data-target="#detailsModal" data-title="<i class=\'fa fa-list fa-fw\'><\/i> Detalles del pedido" data-url="/Order/DetailsOrder/'+t.orderId+'">'+t.orderId.toString().padZero(6,"0")+"<\/a><\/td><td>$"+t.orderTotal.toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")+"<\/td><td>"+t.customerName+"<\/td><\/tr>")}):i.append('<tr><td colspan="3"><span>No hay pedidos para preparar<\/span><\/td><\/tr>')},error:function(t){t.status==401&&n("body").sessionTimeout("show")}})};n.deliveryOrders=function(){n.ajax({method:"GET",url:"/Home/DeliveryOrders",success:function(i){n("#delivertotal").text(i.total);var r=n("#deliverorders").find("tbody");r.html("");i.orders.length>0?n.each(i.orders,function(n,t){r.append('<tr><td><a href="#" class="btn btn-link m-0 p-0" data-toggle="modal" data-target="#detailsModal" data-title="<i class=\'fa fa-list fa-fw\'><\/i> Detalles del pedido" data-url="/Order/DetailsOrder/'+t.orderId+'">'+t.orderId.toString().padZero(6,"0")+"<\/a><\/td><td>$"+t.orderTotal.toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")+"<\/td><td>"+t.customerName+"<\/td><\/tr>")}):r.append('<tr><td colspan="3"><span>No hay pedidos por entregar<\/span><\/td><\/tr>');setTimeout(n.processingOrders,t)},error:function(t){t.status==401&&n("body").sessionTimeout("show")}})};n.completedOrders=function(){n.ajax({method:"GET",url:"/Home/CompletedOrders",success:function(i){n("#completetotal").text(i.total);var r=n("#completeorders").find("tbody");r.html("");i.orders.length>0?n.each(i.orders,function(n,t){r.append('<tr><td><a href="#" class="btn btn-link m-0 p-0" data-toggle="modal" data-target="#detailsModal" data-title="<i class=\'fa fa-list fa-fw\'><\/i> Detalles del pedido" data-url="/Order/DetailsOrder/'+t.orderId+'">'+t.orderId.toString().padZero(6,"0")+"<\/a><\/td><td>$"+t.orderTotal.toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")+"<\/td><td>"+t.customerName+"<\/td><\/tr>")}):r.append('<tr><td colspan="3"><span>No hay pedidos completados<\/span><\/td><\/tr>');setTimeout(n.completedOrders,t)},error:function(t){t.status==401&&n("body").sessionTimeout("show")}})};n.canceledOrders=function(){n.ajax({method:"GET",url:"/Home/CanceledOrders",success:function(i){n("#canceltotal").text(i.total);var r=n("#cancelorders").find("tbody");r.html("");i.orders.length>0?n.each(i.orders,function(n,t){r.append('<tr><td><a href="#" class="btn btn-link m-0 p-0" data-toggle="modal" data-target="#detailsModal" data-title="<i class=\'fa fa-list fa-fw\'><\/i> Detalles del pedido" data-url="/Order/DetailsOrder/'+t.orderId+'">'+t.orderId.toString().padZero(6,"0")+"<\/a><\/td><td>$"+t.orderTotal.toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")+"<\/td><td>"+t.customerName+"<\/td><\/tr>")}):r.append('<tr><td colspan="3"><span>No hay pedidos cancelados<\/span><\/td><\/tr>');setTimeout(n.canceledOrders,t)},error:function(t){t.status==401&&n("body").sessionTimeout("show")}})};n.rejectedOrders=function(){n.ajax({method:"GET",url:"/Home/RejectedOrders",success:function(i){n("#rejectedtotal").text(i.total);var r=n("#rejectedorders").find("tbody");r.html("");i.orders.length>0?n.each(i.orders,function(n,t){r.append('<tr><td><a href="#" class="btn btn-link m-0 p-0" data-toggle="modal" data-target="#detailsModal" data-title="<i class=\'fa fa-list fa-fw\'><\/i> Detalles del pedido" data-url="/Order/DetailsOrder/'+t.orderId+'">'+t.orderId.toString().padZero(6,"0")+"<\/a><\/td><td>$"+t.orderTotal.toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")+"<\/td><td>"+t.customerName+"<\/td><\/tr>")}):r.append('<tr><td colspan="3"><span>No hay pedidos rechazados<\/span><\/td><\/tr>');setTimeout(n.rejectedOrders,t)},error:function(t){t.status==401&&n("body").sessionTimeout("show")}})};n.salesByDay=function(){n.ajax({method:"GET",url:"/Home/SalesByDay",success:function(i){var r=n("#salesbyday").find("tbody");r.html("");n.each(i,function(n,t){r.append("<tr><td>"+t.date+"<\/td><td>"+t.orders+"<\/td><td>$"+t.total.toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")+'<\/td><td><a href="#" class="btn btn-link m-0 p-0" data-toggle="modal" data-target="#detailsModal" data-title="<i class=\'fa fa-list fa-fw\'><\/i> Detalles de la venta" data-url="/Home/SalesByDayDetails/'+t.date.replace(/\//g,"-")+'"><i class="fa fa-info-circle fa-fw"><\/i><\/a><\/td><\/tr>')});setTimeout(n.salesByDay,t)},error:function(t){t.status==401&&n("body").sessionTimeout("show")}})};n.registerDevice=function(){"serviceWorker"in navigator&&Notification.requestPermission(function(t){console.log("Status de las notificaciones:",t);t==="granted"&&navigator.serviceWorker.ready.then(function(t){t.pushManager.getSubscription().then(function(i){i?console.log("El usuario ya recibe notificaciones"):n.get("/Account/ServerKey").then(function(i){var u=i,r={userVisibleOnly:!0},f=urlB64ToUint8Array(u);r.applicationServerKey=f;t.pushManager.subscribe(r).then(function(t){var i=JSON.parse(JSON.stringify(t)),r=i.keys.p256dh,u=i.keys.auth,f=JSON.parse(JSON.stringify({devicePushEndpoint:t.endpoint,devicePushP256dh:r,devicePushAuth:u}));n.ajax({method:"POST",url:"/Account/RegisterDevice",data:f,error:function(n){console.log("[Error:"+n.status+"] No se registro el dispositivo para las notificaciones WebPush")}})})})})})})};n.registerAppleDevice=function(t){if(t!=""){var i=JSON.parse(JSON.stringify({devicePushEndpoint:"Apple",devicePushP256dh:t,devicePushAuth:"Apple"}));n.ajax({method:"POST",url:"/Account/RegisterDevice",data:i,error:function(n){console.log("[Error:"+n.status+"] No se registro el dispositivo para las notificaciones de Apple")}})}};n.submitSearch=function(n){this.init(n)};n.extend(n.submitSearch,{prototype:{init:function(t){this.element=n(t);this.form=this.element.closest("form");this.bind()},bind:function(){this.element.on("click",this,this.submit)},submit:function(t){var i=t.data!=undefined?t.data:t,r;t.preventDefault();r=i.form.serialize();n.ajax({method:"POST",url:i.form.attr("action"),data:r,success:function(t){var i=n("#salesbyday").find("tbody");i.html("");t.length>0?n.each(t,function(n,t){i.append("<tr><td>"+t.date+"<\/td><td>"+t.orders+"<\/td><td>$"+t.total.toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")+'<\/td><td><a href="#" class="btn btn-link m-0 p-0" data-toggle="modal" data-target="#detailsModal" data-title="<i class=\'fa fa-list fa-fw\'><\/i> Detalles de la venta" data-url="/Home/SalesByDayDetails/'+t.date.replace(/\//g,"-")+'"><i class="fa fa-info-circle fa-fw"><\/i><\/a><\/td><\/tr>')}):i.append('<tr><td colspan="4" class="text-center"><i class="fa fa-sad-cry fa-fw"><\/i> Â¡No hay registros para esas fechas!<\/td><tr>')}})}}});n.extend(n.fn,{submitSearch:function(){return this.each(function(){var t=n(this).data("SUBMITSEARCH");return t||(t=new n.submitSearch(this),n(this).data("SUBMITSEARCH",t)),t})}});n.newOrders();n.processingOrders();n.deliveryOrders();n.completedOrders();n.canceledOrders();n.rejectedOrders();n.salesByDay();n.registerDevice();n('[data-action="submitSearch"]').submitSearch()})(jQuery);